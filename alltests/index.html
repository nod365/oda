<!doctype html>
<html lang="ru">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Тестирование сотрудников Avenue Group</title>
  <style>
    :root {
      --bg: #0f1724;
      --card: #0b1220;
      --accent: #06b6d4;
      --muted: #94a3b8;
      --ok: #10b981;
      --bad: #ef4444;
      --glass: rgba(255, 255, 255, 0.03);
      --max-width: 1100px;
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color: #e6eef8
    }

    body:before {
      content: '';
      position: fixed;
      left: 0;
      top: 0;
      height: 100%;
      width: 100%;
      background: linear-gradient(180deg, #42007c 0%, #1a4364 100%);
      z-index: -1;
    }

    .app {
      max-width: var(--max-width);
      margin: 24px auto;
      padding: 20px;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.01));
      box-shadow: 0 8px 30px rgba(2, 6, 23, 0.3);
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 12px
    }

    .brand {
      font-weight: 700;
      letter-spacing: 0.4px
    }

    .meta {
      font-size: 14px;
      color: white
    }

    .screen {
      padding: 20px
    }

    .card {
      background: var(--glass);
      padding: 18px;
      border-radius: 12px
    }

    label {
      font-size: 14px;
      color: white
    }

    input[type=text] {
      font-size: 20px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: transparent;
      color: inherit
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      border-radius: 10px;
      border: 0;
      background: var(--accent);
      color: #042027;
      font-weight: 700;
      cursor: pointer
    }

    .btn.ghost {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      font-weight: 600
    }

    .btn.warn {
      background: var(--bad);
      color: white
    }

    .start-box {
      display: grid;
      gap: 12px;
      max-width: 720px
    }

    .question-wrap {
      display: grid;
      grid-template-columns: 1fr 260px;
      gap: 18px
    }

    .q-main {
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.01), rgba(255, 255, 255, 0.02));
      padding: 18px;
      border-radius: 10px
    }

    .q-side {
      position: relative
    }

    .q-text {
      font-size: 20px;
      margin-bottom: 8px
    }

    .options {
      display: grid;
      gap: 10px
    }

    .option {
      padding: 12px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px
    }

    .option.selected {
      outline: 2px solid #00d4ff;
      background: linear-gradient(90deg, rgba(6, 182, 212, 0.06), transparent)
    }

    .footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 12px
    }

    .pager {
      display: flex;
      gap: 8px
    }

    .qgrid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 6px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 8px
    }

    .qnum {
      padding: 8px;
      border-radius: 6px;
      text-align: center;
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.2)
    }

    .qnum.current {
      background: rgb(63 255 0 / 17%);
      border-color: rgb(4 255 0 / 77%)
    }

    .qnum.answered {
      background: rgba(16, 185, 129, 0.06);
      border-color: rgba(16, 185, 129, 0.3)
    }

    .results {
      display: grid;
      gap: 12px
    }

    .result-item {
      padding: 12px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.007), transparent)
    }

    .correct {
      color: var(--ok);
      font-weight: 700
    }

    .wrong {
      color: var(--bad);
      font-weight: 700
    }

    .small {
      font-size: 13px;
      color: white
    }

    footer.app-footer {
      display: flex;
      justify-content: space-between;
      padding-top: 8px;
      font-size: 13px;
      color: white
    }

    @media (max-width:900px) {
      .question-wrap {
        grid-template-columns: 1fr
      }

      .q-side {
        order: 2
      }
    }
  </style>
</head>

<body>
  <div class="app" id="app">
    <header>
      <div>
        <div class="brand">Avenue Group</div>
        <div class="meta">Тестирование сотрудников</div>
      </div>
      <div class="meta" id="metaRight"></div>
    </header>
    <main class="screen">
      <div id="root"></div>
    </main>
    <footer class="app-footer">
      <div>Разработано: nod365 (・ω・)</div>
      <div class="small">v.9 (multi-test)</div>
    </footer>
  </div>

  <script>
    const TIME_LIMIT = 20 * 60 * 1000;
    const STORAGE_KEY = 'kiosk_test_state_v6';
    const MAX_ATTEMPTS = 3;
    const PASS_THRESHOLD = 80;

    /* --- тестовые наборы --- */
    const BASE_TESTS = {
      /* deprecated
      "Тест Отчет (устарел)": {
        title: "Тест Отчет",
        questions: [ 
          {
            id: 1, q: "Граждане каких стран не могут работать в такси? Выберите верный вариант.",
            options: [
              "Граждане Беларуси и Казахстана",
              "Граждане стран, с которыми у РФ нет соглашения о трудовой деятельности",
              "Все иностранные граждане"
            ],
            answers: [2]
          },
          {
            id: 2, q: "Какие документы необходимы для работы в такси гражданам РФ? Выберите верный вариант.",
            options: [
              "Только паспорт и водительское удостоверение",
              "Паспорт, водительское удостоверение, справка об отсутствии судимости, ИНН, СНИЛС",
              "Заграничный паспорт и диплом об образовании, ИНН, СНИЛС"
            ],
            answers: [2]
          },
          {
            id: 3, q: "Укажите какие акции для водителей действуют в нашей компании? Выберите все правильные варианты.",
            options: [
              "Скидка для пенсионеров 200 руб.",
              "Скидка участникам СВО 50% на первый месяц аренды.",
              "Скидка 200 рублей для жителей Москвы и Подмосковья с постоянной пропиской.",
              "Приведи друга – скидка водителю и другу 400 руб.",
              "Акция для новых водителей, скидка до 400 руб.",
              "Акция для новых водителей, скидка до 500 руб.",
              "Скидка участникам СВО 25% на первый месяц аренды.",
              "Скидка гражданам Киргизии при наличии ВНЖ 300руб."
            ],
            answers: [2, 3, 4, 5]
          },
          {
            id: 4, q: "Укажите какие условия парка для работы в такси? Выберите правильный вариант.",
            options: [
              "Без залога, депозит 200 рублей, день сдачи авто бесплатный, день получения авто бесплатный, сдача авто или пересадка строго до 17:00, сервисный сбор 300р самозанятым или 400р парковым водителям.",
              "Без залога, депозит 200 рублей, день сдачи авто платный, день получения авто бесплатный, сдача авто или пересадка строго до 17:00, сервисный сбор 300р самозанятым или 400р парковым водителям.",
              "Без залога, депозит 200 рублей, деньполучения авто бесплатный, день сдачи авто платный. сдача авто или пересадка строго до 17:00, сервисный сбор 300р самозанятым или 400р парковым водителям.",
              "Без залога, без депозита, день получения авто бесплатный, день сдачи авто платный, сдача авто или пересадка строго до15:00, сервисный сбор 200р самозанятым или 300р парковым водителям."
            ],
            answers: [2]
          },
          {
            id: 5, q: "Выберите правильные элементы дресс-кода в компании. Выберите один верный вариант.",
            options: [
              "Разрешено. Верх: белые рубашки/блузки, допускаются пиджаки нейтральных цветов, рубашки с длинным и коротким рукавом. Низ: брюки, джинсы, юбки ниже колена, классическая обувь. Запрещено: Ношение рубашки на выпуск, шорты, мини-юбки, спортивная одежда любых видов (в том числе военная), кроссовки, головные уборы в помещениях, яркий макияж, сильный парфюм.",
              "Разрешено. Верх: белые рубашки/блузки, белые футболки с бейджами, допускаются куртки нейтральных цветов, рубашки с длинным и коротким рукавом. Низ: брюки, джинсы, юбки ниже колена, сланцы, кеды, любая удобная обувь. Запрещено: Ношение рубашки на выпуск, шорты, мини-юбки, спортивная одежда любых видов (в том числе военная), кроссовки, головные уборы в помещениях, яркий макияж, сильный парфюм",
              "Разрешено. Верх: черные рубашки/блузки, допускаются пиджаки нейтральных цветов, рубашки с длинным и коротким рукавом. Низ: брюки, джинсы, юбки ниже колена, классическая обувь. Запрещено: Ношение рубашки на выпуск, шорты, мини-юбки, спортивная одежда любых видов (в том числе военная), кроссовки, головные уборы в помещениях, яркий макияж, сильный парфюм"
            ],
            answers: [1]
          },
          {
            id: 6, q: "Укажите верные стадии оформления в парке нового водителя. Выберите один верный вариант.",
            options: [
              "Собеседование отчетный отдел, оформление/приемка, диспетчерская, отчетный отдел (путевые листы), инструктаж, оформление",
              "Собеседование отчетный отдел, оформление, инструктаж, оформление/приемка, диспетчерская, отчетный отдел (путевые листы).",
              "Собеседование (администратор), инструктаж, диспетчерская, оформление/приемка, отчетный отдел (путевые листы). "
            ],
            answers: [2]
          },
          {
            id: 7, q: "Что такое КИС АРТ?",
            options: [
              "Система контроля за деятельностью такси",
              "Система анализа рейтинга водителя",
              "Квалификационный индивидуальный сертификат водителя"
            ],
            answers: [1]
          },
          {
            id: 8, q: "Укажите, что входит в понятие сервисный сбор.",
            options: [
              "Фиксированная комиссия таксопарка",
              "Плата за техническое облуживание",
              "Фиксированный платеж за полную операционную поддержку"
            ],
            answers: [1]
          },
          {
            id: 9, q: "В каких случаях менеджер может отказать в выдаче авто? Выберите все правильные варианты.",
            options: [
              "Отсутствие справки о судимости",
              "Плохие комментарии в другом парке",
              "Кандидат находится в алкогольном или наркотическом опьянении",
              "Отсутствие водительского удостоверения",
              "Неопрятный внешний вид",
              "Желание работать только через индрайвер"
            ],
            answers: [3, 4]
          },
          {
            id: 10, q: "Какой анализ по водителю требуется провести перед выдачей путевых листов? Выберите один верный вариант.",
            options: [
              "Баланс «итого» в программе ODA, количество выполняемых заказов за неделю, километраж за неделю",
              "Наличие задолженностей в другом парке",
              "Сколько штрафов получено водителем в текущем месяце"
            ],
            answers: [1]
          },
          {
            id: 11, q: "В каких случаях менеджер может отправить заявку на перенос долга? Выберите один верный вариант.",
            options: [
              "Накопившийся долг по аренде более 50 тыс.руб.",
              "Когда сумма ущерба по ДТП составляет более 100 тыс.руб.",
              "Одновременное получение нескольких штрафов."
            ],
            answers: [3]
          },
          {
            id: 12, q: "Какому водителю можно выдать путевые листы с минусом? Выберите один верный вариант",
            options: [
              "Водителю со стажем в парке более года",
              "Водителю с положительной динамикой по балансу",
              "Только если это водитель нашего парка"
            ],
            answers: [2]
          },
          {
            id: 13, q: "Какому водителю нельзя выдавать путевые листы с минусом? Выберите все  верные варианты.",
            options: [
              "Водителю имеющему штраф 25 тыс.руб",
              "Новому водителю с минусом",
              "Водителю без положительной динамики баланса",
              "Водителю, у которого есть сводный баланс"
            ],
            answers: [2, 3]
          },
          {
            id: 14, q: "Какую информацию о водителе менеджеру нужно передавать в СБ? Выберите верный вариант.",
            options: [
              "ФИО водителя, номер машины, номер телефона водителя, дополнительные номера телефонов, аккаунт Старлайн, причины обращения",
              "ФИО водителя, номер машины, причины обращения",
              "Достаточно номер телефона водителя и причины обращения"
            ],
            answers: [1]
          },
          {
            id: 15, q: "Кто такой «ЭКС»? Выберите верный вариант.",
            options: [
              "Уволивший из парка водитель с долгами",
              "Водитель сдавший автомобиль без официальной процедуры приема/сдачи в парке",
              "Водитель оставивший автомобиль на дороге и пришедший в парк с документами"
            ],
            answers: [2]
          }
         ]
      },
      */
      "Тест Отчет (Новый)": {
        title: "Тест Отчет (Новый)",
        questions: [
          {
            id: 1, q: "Граждане каких стран не могут работать в такси? Выберите верный вариант.",
            options: [
              "Граждане Беларуси и Казахстана",
              "Граждане стран, с которыми у РФ нет соглашения о трудовой деятельности",
              "Все иностранные граждане"
            ],
            answers: [2]
          },
          {
            id: 2, q: "Какие документы необходимы для работы в такси гражданам РФ? Выберите верный вариант.",
            options: [
              "Только паспорт и водительское удостоверение",
              "Паспорт, водительское удостоверение, справка об отсутствии судимости, ИНН, СНИЛС",
              "Заграничный паспорт и диплом об образовании, ИНН, СНИЛС"
            ],
            answers: [2]
          },
          {
            id: 3, q: "Укажите какие акции для водителей действуют в компании? Выберите все правильные варианты.",
            options: [
              "Скидка для пенсионеров 200 руб.",
              "Скидка участникам СВО 50% на первый месяц аренды.",
              "Скидка 100 рублей для жителей Москвы и Подмосковья с постоянной пропиской",
              "Приведи друга – скидки водителю и другу от 100 до 300 руб.",
              "Акция для новых водителей, скидка до 300 руб.",
              "Акция для новых водителей, скидка до 700 руб.",
              "Скидка родственникам участников СВО 25% на первый месяц аренды.",
              "Скидка гражданам Киргизии при наличии ВНЖ 300руб."
            ],
            answers: [2,3,4,6,7]
          },
          {
            id: 4, q: "Укажите какие условия парка для работы в такси? Выберите правильный вариант.",
            options: [
              "Без залога, без депозита, день сдачи авто бесплатный, день получения авто бесплатный, сдача авто строго до 17:00, сервисный сбор 300р самозанятым или 400р парковым водителям.",
              "Без залога, депозит 200р, день сдачи авто платный, день получения авто бесплатный, сдача авто строго до 17:00, сервисный сбор 300р самозанятым или 400р парковым водителям.",
              "Без залога, без депозита, день получения авто бесплатный, день сдачи авто платный. сдача авто строго до 17:00, сервисный сбор 300р самозанятым или 400р парковым водителям.",
              "Без залога, без депозита, день получения авто бесплатный, день сдачи авто платный, сдача авто строго до 15:00, сервисный сбор 200р самозанятым или 300р парковым водителям."
            ],
            answers: [3]
          },
          {
            id: 5, q: "Выберите правильные элементы дресс-кода в компании. Выберите один верный вариант.",
            options: [
              "<br>Разрешено. Верх: белые рубашки/блузки, допускаются пиджаки нейтральных цветов, рубашки с длинным и коротким рукавом. Низ: брюки, джинсы, юбки ниже колена, классическая обувь. <br>Запрещено: Ношение рубашки на выпуск, шорты, мини-юбки, спортивная одежда любых видов (в том числе военная), кроссовки, головные уборы в помещениях, яркий макияж, сильный парфюм.",
              "<br>Разрешено. Верх: белые рубашки/блузки, белые футболки с бейджами, допускаются куртки нейтральных цветов, рубашки с длинным и коротким рукавом. Низ: брюки, джинсы, юбки ниже колена, сланцы, кеды, любая удобная обувь. <br>Запрещено: Ношение рубашки на выпуск, шорты, мини-юбки, спортивная одежда любых видов (в том числе военная), кроссовки, головные уборы в помещениях, яркий макияж, сильный парфюм.",
              "<br>Разрешено. Верх: черные рубашки/блузки, допускаются пиджаки нейтральных цветов, рубашки с длинным и коротким рукавом. Низ: брюки, джинсы, юбки ниже колена, классическая обувь.<br>Запрещено: Ношение рубашки на выпуск, шорты, мини-юбки, спортивная одежда любых видов (в том числе военная), кроссовки, головные уборы в помещениях, яркий макияж, сильный парфюм."
            ],
            answers: [1]
          },
          {
            id: 6, q: "Укажите верные стадии оформления в парке нового водителя. Выберите один верный вариант.",
            options: [
              "Собеседование (отчетный отдел), оформление/приемка, диспетчерская, отчетный отдел (путевые листы), инструктаж, оформление.",
              "Собеседование (отчетный отдел), оформление, инструктаж, оформление/приемка, диспетчерская, отчетный отдел (путевые листы).",
              "Собеседование (администратор), инструктаж, диспетчерская, оформление/приемка, отчетный отдел (путевые листы)."
            ],
            answers: [2]
          },
          {
            id: 7, q: "Что такое КИС АРТ?",
            options: [
              "Система контроля за деятельностью такси",
              "Система анализа рейтинга водителя",
              "Квалификационный индивидуальный сертификат водителя"
            ],
            answers: [1]
          },
          {
            id: 8, q: "Укажите, что входит в понятие сервисный сбор.",
            options: [
              "Фиксированная комиссия таксопарка",
              "Плата за техническое облуживание",
              "Фиксированный платеж за полную операционную поддержку"
            ],
            answers: [3]
          },
          {
            id: 9, q: "В каких случаях менеджер может отказать в выдаче авто? Выберите все правильные варианты.",
            options: [
              "Отсутствие справки о судимости",
              "Плохие комментарии в другом парке",
              "Кандидат находится в алкогольном или наркотическом опьянении",
              "Отсутствие водительского удостоверения",
              "Неопрятный внешний вид",
              "Желание работать только через индрайвер"
            ],
            answers: [3,4]
          },
          {
            id: 10, q: "Какой анализ по водителю требуется провести перед выдачей путевых листов? Выберите один верный вариант.",
            options: [
              "Баланс «Итого» в программе ODA, количество выполняемых заказов за неделю, километраж за неделю",
              "Наличие задолженностей в другом парке",
              "Сколько штрафов получено водителем в текущем месяце"
            ],
            answers: [1]
          },
          {
            id: 11, q: "В каких случаях менеджер может отправить заявку на перенос долга? Выберите один верный вариант.",
            options: [
              "Накопившийся долг по аренде более 50 тыс.руб.",
              "Когда сумма ущерба по ДТП составляет более 100 тыс.руб.",
              "Одновременное получение нескольких штрафов"
            ],
            answers: [3]
          },
          {
            id: 12, q: "Какому водителю можно выдать путевые листы с минусом? Выберите один верный вариант.",
            options: [
              "Водителю со стажем в парке более года",
              "Водителю с положительной динамикой по балансу",
              "Только если это водитель нашего парка"
            ],
            answers: [2]
          },
          {
            id: 13, q: "Какому водителю нельзя выдавать путевые листы с минусом? Выберите все верные варианты.",
            options: [
              "Водителю, имеющему штраф 25 тыс.руб",
              "Новому водителю с минусом",
              "Водителю без положительной динамики баланса",
              "Водителю, у которого есть сводный баланс"
            ],
            answers: [2,3]
          },
          {
            id: 14, q: "Какую информацию о водителе менеджеру нужно передавать в СБ? Выберите верный вариант.",
            options: [
              "ФИО водителя, номер машины, номер телефона водителя, дополнительные номера телефонов, аккаунт Старлайн, причины обращения",
              "ФИО водителя, номер машины, причины обращения",
              "Достаточно номер телефона водителя и причины обращения"
            ],
            answers: [1]
          },
          {
            id: 15, q: "Кто такой «ЭКС»? Выберите верный вариант.",
            options: [
              "Уволивший из парка водитель с долгами",
              "Водитель сдавший автомобиль без официальной процедуры приема/сдачи в парке",
              "Водитель оставивший автомобиль на дороге и пришедший в парк с документами"
            ],
            answers: [2]
          },
          {
            id: 16, q: "В какое время менеджеру отчетного отдела необходимо быть утром на работе? ",
            options: [
              "В 9:50, так как необходимо успеть до начала рабочего дня переодеться, проверить что все программы работают (ODA, Starline и пр.) и определить с руководителем приоритеты в задачах на день. Далее в 10.00 начать прием водителей.",
              "В 10:00. Далее переодеться, получить задачи от руководителя и начать прием водителей (при их наличии).",
              "Можно приходить в 10:15, так как с утра никогда не бывает много водителей. Кто-нибудь из коллег меня подменит, если что."
            ],
            answers: [1]
          },
          {
            id: 17, q: "Что такое МАДИ?",
            options: [
              "Подразделение патрульно-постовой службы",
              "Московская административно-дорожная инспекция",
              "Московский Автодорожный Институт"
            ],
            answers: [2]
          },
          {
            id: 18, q: "Что такое ОСГОП?",
            options: [
              "Страхование пассажиров в такси",
              "Страхование жизни и здоровья водителя такси",
              "Страхование перевозимого багажа в такси"
            ],
            answers: [1]
          },
          /*{
            id: 19, q: "Что такое КИС АРТ?",
            options: [
              "Стратегическая аналитика безопасности в такси",
              "Система контроля за движением автомобилей на дорогах",
              "Система контроля за деятельностью такси"
            ],
            answers: [3]
          },*/
          {
            id: 20, q: "Какие из перечисленных функций НЕ входят в зону ответственности КИС АРТ? Выберите верные варианты.",
            options: [
              "Контроль соблюдения требований к цветографическому оформлению автомобилей такси.",
              "Проверка наличия и действительности полиса ОСАГО у водителя.",
              "Анализ маршрутов и скоростного режима для выявления потенциально опасного вождения.",
              "Приём жалоб от пассажиров через мобильное приложение.",
              "Мониторинг рабочего времени водителей для предотвращения нарушений трудового законодательства."
            ],
            answers: [2,4,5]
          },
          {
            id: 21, q: "В каком случае водитель обязан позвонить в таксопарк? Выберите верные варианты.",
            options: [
              "Если попал в ДТП",
              "Если не работает навигатор",
              "Если машина заглохла и не заводится",
              "Если закончился бензин/газ",
              "Если обнаружил, что при себе нет путевого листа"
            ],
            answers: [1,3,5]
          },
          {
            id: 22, q: "Кто будет привлечен к ответственности и каким органом, если автомобиль, принадлежащий юридическому лицу (ООО «Вектор»), будет зафиксирован камерой, совершающим одновременно два нарушения: <br>1) Неоплаченная парковка; <br>2) Выезд за стоп-линию перед перекрестком?",
            options: [
              "Оба нарушения рассмотрит МАДИ, так как автомобиль принадлежит юридическому лицу.",
              "Оба нарушения рассмотрит ГИБДД, так как выезд за стоп-линию — это более серьезное нарушение.",
              "Нарушение №1 (парковка) рассмотрит МАДИ, а нарушение №2 (стоп-линия) — ГИБДД. По каждому из них будет вынесено отдельное постановление.",
              "Нарушения будут объединены в одно производство, которое рассмотрит районный суд."
            ],
            answers: [3]
          },
          {
            id: 23, q: "Что необходимо проверять по новым водителям на ежедневной основе? Выберите верные варианты.",
            options: [
              "Отсутствие долгов по аренде",
              "Наличие у них справки о судимости",
              "Наличие 50% бензина в баке",
              "Наличие заказов",
              "Вывод заработанных средств на банковскую карту"
            ],
            answers: [1,4]
          },
          {
            id: 24, q: "С какой целью осуществляется обзвон водителей по «Итого»?",
            options: [
              "С целью оплаты по водителям с наличием долга по аренде",
              "С целью оплаты по водителям с наличием штрафа",
              "С целью оформления путевых листов всем действующим водителям подразделения",
              "С целью оплаты водителями сервисного сбора"
            ],
            answers: [1]
          },
          {
            id: 25, q: "Зачем осуществляется обзвон уволенных ранее водителей без долгов? Выберите верные варианты.",
            options: [
              "Выяснить новое место работы водителя",
              "Подтвердить договоренности о приезде водителя в парк по статусам таблицы одобрения",
              "Проинформировать о новых акциях/предложениях/машинах с целью привлечения",
              "Сообщить о полученном штрафе на водителя",
              "Сообщить об изменениях законодательства в части таксомоторной деятельности"
            ],
            answers: [2,3]
          },
        ]
      },
      "Тест Франшиза": {
        title: "Тест Франшиза",
        questions: [
          {
            id: 1, q: "Что такое франшиза?",
            options: [
              "Дополнительный налог",
              "Штраф за нарушение ПДД",
              "Система финансовой защиты при ДТП",
              "Бонус за безаварийную езду"
            ],
            answers: [3]
          },
          {
            id: 2, q: "Сколько рублей в день списывается за франшизу?",
            options: [
              "100 ₽",
              "200 ₽",
              "300 ₽",
              "500 ₽"
            ],
            answers: [2]
          },
          {
            id: 3, q: "Франшиза начинает действовать при ущербе от:",
            options: [
              "10 000 ₽",
              "25 000 ₽",
              "50 000 ₽",
              "100 000 ₽"
            ],
            answers: [2]
          },
          {
            id: 4, q: "Какой максимальный платеж водителя за одно ДТП?",
            options: [
              "10 000 ₽",
              "25 000 ₽",
              "50 000 ₽",
              "Нет ограничений"
            ],
            answers: [2]
          },
          {
            id: 5, q: "Если ущерб в ДТП — 20 000 ₽?",
            options: [
              "Водитель оплатит 20 000 ₽",
              "Франшиза покроет 15 000 ₽",
              "Водитель ничего не платит",
              "Ущерб переносится на следующий месяц"
            ],
            answers: [1]
          },
          {
            id: 6, q: "Если водитель попал в два ДТП за день (100 000 ₽ и 50 000 ₽), сколько он заплатит?",
            options: [
              "25 000 ₽ за оба",
              "50 000 ₽",
              "75 000 ₽",
              "150 000 ₽"
            ],
            answers: [2]
          },
          {
            id: 7, q: "Как учитываются несколько ДТП по франшизе?",
            options: [
              "Суммируются в общий ущерб",
              "Каждое ДТП — отдельный случай",
              "Учитывается только первое ДТП",
              "Зависит от времени между авариями"
            ],
            answers: [2]
          },
          {
            id: 8, q: "Если ущерб в ДТП — 25 000 ₽?",
            options: [
              "Водитель платит 25 000 ₽",
              "Франшиза не применяется (ровно 25 000 ₽)",
              "Водитель платит 12 500 ₽",
              "Ущерб покрывается полностью"
            ],
            answers: [1]
          },
          {
            id: 9, q: "Если водитель попал в три ДТП за месяц (50 000 ₽, 30 000 ₽, 100 000 ₽), какова его общая выплата?",
            options: [
              "25 000 ₽",
              "50 000 ₽",
              "75 000 ₽",
              "180 000 ₽"
            ],
            answers: [3]
          },
          {
            id: 10, q: "Можно ли отказаться от франшизы?",
            options: [
              "Да, написав заявление",
              "Да, но с повышением других платежей",
              "Только для водителей со стажем >5 лет",
              "Нет, это обязательный платеж"
            ],
            answers: [4]
          },
          {
            id: 11, q: "Если ущерб в ДТП — 200 000 ₽, сколько заплатит водитель?",
            options: [
              "25 000 ₽",
              "50 000 ₽",
              "100 000 ₽",
              "200 000 ₽"
            ],
            answers: [1]
          },
          {
            id: 12, q: "Как франшиза влияет на отчетность водителя?",
            options: [
              "Увеличивает штрафы",
              "Освобождает от ответственности",
              "Минимизирует финансовые потери",
              "Уменьшает страховые выплаты"
            ],
            answers: [3]
          },
          {
            id: 13, q: "Главное преимущество франшизы для водителя:",
            options: [
              "Бесплатный ремонт",
              "Отмена штрафов",
              "Фиксированные затраты при ДТП",
              "Скидки на топливо"
            ],
            answers: [3]
          },
          {
            id: 15, q: "Почему франшизу можно сравнить с «подушкой безопасности»?",
            options: [
              "Она защищает от штрафов",
              "Ограничивает максимальные расходы",
              "Позволяет не платить за мелкие повреждения",
              "Дает бонусы за аккуратную езду"
            ],
            answers: [2]
          },
          {
            id: 16, q: "Какое утверждение о франшизе неверно?",
            options: [
              "Она обязательна для всех",
              "Покрывает ущерб до 25 000 ₽",
              "ДТП учитываются отдельно",
              "Ежедневный платеж — 200 ₽"
            ],
            answers: [2]
          },
          {
            id: 17, q: "Как лучше объяснить водителю пользу франшизы?",
            options: [
              "Это дополнительный налог",
              "Это защита от больших расходов при аварии",
              "Это штраф за рискованную езду",
              "Это добровольный взнос"
            ],
            answers: [2]
          },
          {
            id: 18, q: "Что произойдет, если водитель не попадет в ДТП за год?",
            options: [
              "Он получит возврат денег",
              "Платежи не возвращаются",
              "Сумма переносится на следующий год",
              "Франшиза отменяется"
            ],
            answers: [2]
          },


          /*
                {
                  id: 15, q: "ВОПРОС_1",
                  options: [
                    "правильно",
                    "неправильно",
                    "неправильно"
                  ],
                  answers: [1]
                },
          */


        ]
      },
      "Тест Диспетчерская": {
        title: "Тест Диспетчерская",
        questions: [
          {
            id: 1, q: "Что необходимо проверить прежде чем отдать водителю карточку ТС?",
            options: [
              "Данные на ФГИС (орган выдавший разрешение, номер разрешения, дату записи, перевозчика), данные ОСГОП",
              "Номер ТС орган выдавший разрешение, остальные данные бывают заполнены правильно автоматически, ОСАГО",
              "QR code, номер лицензии, гос. Номер, перевозчика"
            ],
            answers: [1]
          },
          {
            id: 2, q: "Какими уполномоченным органом выдаётся разрешения на перевозку пассажиров и багажа в Москве?",
            options: [
              "Департамент транспорта Москвы",
              "В любой частной организации",
              "Департамент транспорта МО"
            ],
            answers: [1]
          },
          {
            id: 3, q: "Граждане каких стран могут работать самозанятыми?",
            options: [
              "Россия, Армения, Беларусь, Казахстан, Кыргызстан, Узбекистан (как государство-наблюдатель в ЕАЭС)",
              "Все государства-участники ЕАЭС: Россия, Армения, Беларусь, Казахстан, Кыргызстан, а также Таджикистан (как кандидат на вступление)",
              "Россия, Беларусь, Казахстан, Кыргызстан, Армения (по Соглашению о порядке осуществления деятельности граждан)",
              "Россия, Армения, Беларусь, Казахстан (как государства-учредители Таможенного союза)"
            ],
            answers: [3]
          },
          {
            id: 4, q: "Что такое ОСГОП?",
            options: [
              "Обязательное страхование автогражданской ответственности",
              "Основное страхование гражданских обязательств перевозчика",
              "Общее соглашение о гражданской ответственности перевозчика",
              "Обязательное страхование гражданской ответственности перевозчика перед пассажирами"
            ],
            answers: [4]
          },
          {
            id: 5, q: "Где действует Московская лицензия легкового такси?",
            options: [
              "По Москве и Московской области",
              "По всей России",
              "Только по Москве"
            ],
            answers: [1]
          },
          {
            id: 6, q: "В каких случаях иностранные  граждане могут оформлять ИП?",
            options: [
              "Может любой оформиться",
              "Граждане Евро-Азиатского экономического союза",
              "При наличии ВНЖ или РВП"
            ],
            answers: [3]
          },
          {
            id: 7, q: "Какой минимальный проходной год выпуска автомобиля на Polo для Яндекс такси на 2026 год?",
            options: [
              "2016",
              "2018",
              "2020",
              "2025"
            ],
            answers: [2]
          },
          {
            id: 8, q: "Какие нужны документы для отгона автомобиля со штрафстоянки?",
            options: [
              "Папка с документами на автомобиль и доверенность",
              "Доверенность и папка с документами на автомобиль, ПЛ без отметки механика.",
              "Водитель не может самостоятельно отогнать автомобиль"
            ],
            answers: [2]
          },
          {
            id: 9, q: "С каким типом занятости может работать водитель в такси?",
            options: [
              "Самозанятый, ИП , трудовой договор",
              "Самозанятый и ИП",
              "Только самозанятый"
            ],
            answers: [1]
          },
          {
            id: 10, q: "Что необходимо для прохождения аттестации в КИС АРТ?",
            options: [
              "Справка о прописке с Госуслуг",
              "Справка об отсутствии или наличии судимости",
              "Выписка из трудовой книжки"
            ],
            answers: [2]
          },
          {
            id: 11, q: "Что нужно делать, если на желтых номерах нет даты окончания срока действия СТС?",
            options: [
              "Ничего не нужно в СТС не бывает ошибок",
              "Передать информацию руководителю отдела или отделу документации, вписать дату окончания разрешения перевозчика",
              "Вписать любую дату"
            ],
            answers: [2]
          },
          {
            id: 12, q: "Водитель просит сделать доверенность на право управление ТС, ваши действия?",
            options: [
              "Я не должен делать такую доверенность",
              "Выдать водителю ведь клиент всегда прав",
              "Запросить у руководителя парка разрешение на выдачу доверенности на право управление ТС"
            ],
            answers: [3]
          },
          {
            id: 13, q: "Водитель первый раз устраивается работать в такси, Вы оформили ему временный КИС АРТ. О чем необходимо проинформировать водителя?",
            options: [
              "КИС АРТ придет через 3 дня",
              "КИС АРТ временный на 30 дней. Водителю необходимо самостоятельно заказать справку в электронном виде об отсутствии судимости РФ (и национального образца для иностранных граждан), и загрузить ее в КИС АРТ в течении 30 дней, в противном случае водитель будет заблокирован.",
              "КИС АРТ временный на 30 дней. Водителю нужно самостоятельно заказать справку в электронном виде об отсутствии судимости РФ (и национального образца для иностранных граждан), а далее составить запрос на компенсацию. "
            ],
            answers: [2]
          },
          {
            id: 14, q: "Что необходимо сделать, если у нового водителя после того как он зашел в профиль в Яндекс Про высвечивается не его ФИО?",
            options: [
              "Обратиться в поддержку Яндекса, чтобы по водителю исправили ошибку",
              "Удалить профиль водителя через 1С и создать новый",
              "Обратиться к руководителю парка, чтобы исправил ошибку"
            ],
            answers: [1]
          },
          {
            id: 15, q: "На ФГИС у автомобиля перевозчик отличается от названия организации, при выдачи авто что необходимо проверить чтобы было у водителя в папке с документами?",
            options: [
              "ОСАГО, ОСГОП, СТС, ДК",
              "Акт приема передачи авто от организации к перевозчику в папке у водителя",
              "Карточка ТС"
            ],
            answers: [2]
          },
          {
            id: 16, q: "Водителю не приходит КИС АРТ, он говорит, что сдаст машину в парк, ваши действия?",
            options: [
              "Указать на то что он должен приходить уже готовым к нам, что это его проблема",
              "Сказать, чтобы подождал, так как вы ничего не можете",
              "Предложить альтернативные варианты работы пока не придет КИС АРТ (Доставка, InDriver), затем отвести к руководителю парка или сотруднику оформления",
              "Принять автомобиль и согласовать сдачу в группе «Отчет» в Телеграмм"
            ],
            answers: [3]
          },
          {
            id: 17, q: "Водитель превысил лимит по самозанятому в 2,4 млн. рублей, и спрашивает как ему сейчас работать?",
            options: [
              "Водителю необходимо открыть ИП, пока открывается ИП переключить его на парковый профиль в Яндексе и в ОDA, чтобы он мог работать на линии",
              "Сказать чтобы возвращался в новом году",
              "Подключить на паркового самозанятого"
            ],
            answers: [1]
          },
          {
            id: 18, q: "Если нет какого-либо документа в базе сканов/ОDA/1C, что необходимо выполнить?",
            options: [
              "Это не моя проблема. Если документа нет - значит его нет.",
              "Поищу документы, спрошу у коллег, обращусь к руководителю отдела.",
              "Найду старый документ отредактирую его по датам сохраню."
            ],
            answers: [2]
          },
          {
            id: 19, q: "У тебя есть задачи на данный момент, расставь их по приоритету. \n\nА - Обзвон водителей по задаче от руководителя. \nБ - Внесение СТС в системы (ОДА, 1С) и базу сканов. \nВ – В кабинет есть водители с вопросами. \nГ - Внести лицензии в системы (ОДА, 1С) и базу сканов, обзвонить водителей для замены лицензии, карточки ТС и путевых листов \nД - Сделать доверенность сотруднику СБ",
            options: [
              "Порядок: Д, В, Б, Г, А",
              "Порядок: А, Г, Б, В, Д",
              "Порядок: А, Г, В, Б, Д",
              "Порядок: В, Д, Г, Б, А",
              "Порядок: Г, А, В, Д, Б",
              "Порядок: Г, А, В, Б, Д",
              "Порядок: В, Г, Д, А, Б"
            ],
            answers: [4]
          },
          {
            id: 20, q: "Менеджер отчетного отдела просит помощи, так как сам не может разобраться в следующем вопросе: водителю пришел штраф, он говорит, что он не ездил за рулем в это время, как проверить?",
            options: [
              "Этот вопрос может решить только руководитель парка. Отправлю сотрудника к нему с этим вопросом.",
              "Скажу менеджеру отчетного отдела, что это не мое дело. Пусть разбирается сам в этом вопросе.",
              "Посмотреть статус водителя на момент нарушения, проверить выдавались ли ему путевые листы на этот автомобиль, посмотреть по программе StarLine где была машина в это время, посмотреть по Яндекс картам (панораме)",
              "Система не может ошибаться, если штраф пришел значит нарушил, необходимо оплачивать."
            ],
            answers: [3]
          }
        ]
      },
      "Тест Приёмка": {
        title: "Тест Приёмка",
        questions: [
          {
            id: 1, q: "Выберите правильный порядок действий сотрудника приемки при сдаче автомобиля (при условии что у автомобиля нет повреждений).",
            options: [
              "Выяснить причину сдачи автомобиля. Сообщить в отчетный отдел в Телеграмм группу парка. Найти старые фото автомобиля в ODA, сравнить с данными фото текущее состояние автомобиля. Проверить внешнее и внутреннее состояние автомобиля на предмет повреждений и загрязнений. Отправить водителя с документами на машину в отдел отчета для оформления сдачи. Проверить наличие ключей в машине.",
              "Выяснить причину сдачи автомобиля. Отправить водителя с документами на машину в отдел отчета для оформления сдачи. Найти старые фото автомобиля в ODA, сравнить с данными фото текущее состояние автомобиля. Проверить внешнее и внутреннее состояние автомобиля на предмет повреждений и загрязнений.",
              "Сообщить в отчетный отдел в Телеграмм группу парка. Найти старые фото автомобиля в ODA, сравнить с данными фото текущее состояние автомобиля. Проверить внешнее и внутреннее состояние автомобиля на предмет повреждений и загрязнений. Отправить водителя с документами на машину в отдел отчета для оформления сдачи. Проверить наличие ключей в машине."
            ],
            answers: [1]
          },
          {
            id: 2, q: "Выберите правильный порядок действий сотрудника приемки при обнаружении повреждений.",
            options: [
              "Сфотографировать повреждение. Отправить в отчетный отдел фото повреждения. Проверить по таблице запчастей стоимость детали. Сообщить водителю о необходимости оплаты данной стоимости в отчетном кабинете. Выяснить у водителя когда и где было получено повреждение.",
              "Выяснить у водителя когда и при каких обстоятельствах было получено повреждение.  Проверить фотографии в ODA, которые были сделаны ранее при выдаче автомобиля на предмет наличия данного повреждения при выдаче. Сообщить оценщику о наличии повреждений (предоставить фото повреждений). Сообщить водителю, что информация об оценке ущерба будет предоставлена водителю позднее в отчетном отделе.",
              "Проверить фотографии в ODA, которые были сделаны ранее при выдаче автомобиля на предмет наличия данного повреждения при выдаче. Сообщить отчетнику о наличии повреждений (предоставить фото повреждений). Сообщить водителю, что оценка ущерба производится в отчетном отделе. "
            ],
            answers: [2]
          },
          {
            id: 3, q: "На автомобиле Клиента, приехавшего в парк на замену автомобиля не работает стеклоочиститель. Как должен поступить приемщик? ",
            options: [
              "Удержать водителя от сдачи. Направить водителя на экстренный ремонт в сервис сопроводив (по возможности) водителя до слесарного цеха.",
              "Принять автомобиль по соответствующей процедуре приемки. Направить водителя в отдел оформления для сдачи и подбора нового автомобиля.",
              "Принять автомобиль по соответствующей процедуре приемки. Выдать другой аналогичный автомобиль из имеющихся на витрине. Сообщить в отдел оформления о выдаче другого автомобиля. Направить водителя за документами на новую машину в отдел оформления."
            ],
            answers: [1]
          },
          {
            id: 4, q: "При сдаче автомобиля сотрудник приемки обнаружил сильные загрязнения салона. Какие действия необходимо предпринять?",
            options: [
              "Сообщить водителю о том, что химчистка стоит 2000 рублей. Принять у водителя данные деньги и отогнать автомобиль на химчистку. Отправить водителя в отчетный отдел для сдачи документов на машину.",
              "Попросить водителя сделать химчистку самостоятельно. В случае отказа, сообщить водителю о том, что парк не производит химчистку салона и что автомобиль не будет принят до тех пор, пока водитель не приведет автомобиль в надлежащий вид.",
              "Попросить водителя сделать химчистку самостоятельно. В случае отказа, сообщить водителю о том, что парк взимает штраф за сдачу грязного салона. Сообщить по установленной процедуре сотрудникам парка, о том что водитель отказался делать химчистку, чтобы в дальнейшем стоимость химчистки была оплачена водителем."
            ],
            answers: [3]
          },
          {
            id: 5, q: "В какое время сотруднику приемки необходимо быть утром на работе?",
            options: [
              "В 9.50, так как необходимо успеть до начала рабочего дня переодеться, осмотреть витрину автомобилей, сделать фотографии витрины и отправить их в общую Телеграмм группу парка для оценки состояния готовности к работе. ",
              "В 10.00. Далее переодеться, получить задачи от руководителя и начать прием водителей (при их наличии).",
              "Можно приходить в  10.15, так как с утра никогда не бывает много водителей и кто-нибудь из коллег меня подменит если что."
            ],
            answers: [1]
          },
          {
            id: 6, q: "Водитель при получении автомобиля сообщил о низком уровне топлива в баке автомобиля (горит лампочка индикации низкого уровня топлива). Какие действия должен предпринять сотрудник приемки?",
            options: [
              "Сообщить водителю адрес ближайшей заправки и пусть там заправится.",
              "Залить 5 литров бензина из имеющегося запаса на приемке. В случае отсутствия бензина в запасе проверить остаток километража по показаниям приборов. Если запас хода позволяет водителю доехать до ближайшей заправки направить его туда. Если по приборам автомобиля невозможно определить запас хода сообщить руководителю о необходимости докупить бензин и попросить водителя немного подождать пока привезут бензин на приемку.",
              "Парк не осуществляет дозаливку бензина. Предложить водителю пересесть на другой автомобиль и отправить его на переоформление."
            ],
            answers: [2]
          },
          {
            id: 7, q: "При сдаче автомобиля водитель пожаловался на посторонние шумы в двигателе автомобиля. Что необходимо предпринять приемщику в данном случае?",
            options: [
              "Необходимо опросить водителя о причинах шума. Записать данные показания на бумажку и положить ее под лобовое стекло автомобиля.",
              "Ничего предпринимать не нужно. Просто осуществить приемку автомобиля по стандартной процедуре.",
              "Необходимо опросить водителя о причинах шума и передать данную информацию в общую Телеграмм группу парка по сервису, чтобы при прогоне автомобиля осуществили диагностику."
            ],
            answers: [3]
          },
          {
            id: 8, q: "Какими ключевыми компетенциями и навыками должен обладать сотрудник для эффективного проведения приёмки? ",
            options: [
              "Никаких особых навыков иметь не нужно. Главное должна быть своя голова на плечах.",
              "Иметь навыки ремонта автомобиля, а также уметь хорошо водить машину.",
              "Иметь навыки делового общения, быть коммуникабельным, внимательным и пунктуальным."
            ],
            answers: [3]
          },
          {
            id: 9, q: "Сотрудник приемки консультирует посетителя с улицы (показывает машины на витрине). В этот момент приезжает действующий водитель, чтобы сдать автомобиль, параллельно звонит телефон – руководитель ставит индивидуальную задачу по отгону одного из автомобилей в сервис. В какой последовательности сотрудник будет решать задачи?",
            options: [
              "Попросит посетителя и действующего водителя подождать. Отгонит в сервис по заданию руководителя машину и затем вернется снова на витрину продолжать работу с водителями.",
              "Сообщит руководителю, что принял задачу, но сможет ее выполнить позже, так как сначала нужно проконсультировать посетителя, направить его в отдел оформления, а затем по стандартной процедуре принять действующего водителя.",
              "Попросит руководителя поручить эту задачу кому-нибудь другому, так как очень занят сейчас и не сможет выполнить поручение руководителя."
            ],
            answers: [2]
          },
          {
            id: 10, q: "Что из перечисленного НЕ участвует в процессе \"Приемка автомобиля\". Выберите нужные варианты",
            options: [
              "Информирование сотрудников парка о сдаче машины",
              "Проверка уровня технических жидкостей автомобиля",
              "Выяснение причин сдачи автомобиля",
              "Техническая мойка автомобиля",
              "Прогон автомобиля по территории парка"
            ],
            answers: [2, 4, 5]
          },
          {
            id: 11, q: "Что из перечисленного не может находиться в автомобиле, подготовленном к выдаче и выставленном на витрину? Выберите нужные варианты.",
            options: [
              "Путевой лист на сегодняшний день.",
              "Карточка автомобиля, установленная на торпедо.",
              "Личные вещи, оставленные предыдущим водителем.",
              "Пачка сигарет и банка с энергетиком.",
              "Знак аварийной остановки."
            ],
            answers: [1, 3, 4]
          },
          {
            id: 12, q: "Что необходимо сделать приемщику с автомобилем после того как пройдена стандартная процедура приемки автомобиля?",
            options: [
              "Отогнать машину в сервис на диагностику в этот же день, а при отсутствии возможностей отогнать на свободное место парковки для дальнейшей передачи парковщику и перегону в сервис на диагностику.",
              "Переставить автомобиль на витрину, так как он в хорошем внешнем состоянии и его можно сразу выдавать другому водителю.",
              "Сесть за руль и поехать по ближайшей к таксопарку улице (на прогон), чтобы удостовериться, что с машиной все в порядке. Затем вернуться и поставить автомобиль на витрину."
            ],
            answers: [1]
          },
          {
            id: 13, q: "Какие фотографии необходимо сделать по автомобилю при его выдаче новому водителю?",
            options: [
              "Общие фото с четырех сторон, передний бампер с трех сторон, задний бампер с двух сторон, подкапотное пространство, фото решетки бампера, лобовое стекло, боковые зеркала с двух сторон, салон сидения по отдельности, потолок с двух сторон, общий вид торпеды с козырьками, состояние бензина, фото комплектации автомобиля (запаска, домкрат, баллонный ключ, знак аварийной остановки, аптечка, трос крюк)",
              "Общие фото с четырех сторон, передний бампер с трех сторон, задний бампер с двух сторон, каждое колесо отдельно, подкапотное пространство, фото решетки бампера, лобовое стекло, боковые зеркала с двух сторон, салон сидения по отдельности, потолок с двух сторон, общий вид торпеды с козырьками, состояние бензина, фары с обеих сторон, фото комплектации автомобиля (запаска, домкрат, баллонный ключ, знак аварийной остановки, аптечка, трос, крюк)",
              "Общие фото с четырех сторон, передний бампер с трех сторон, задний бампер с двух сторон, каждое колесо отдельно, подкапотное пространство, боковые зеркала с двух сторон, салон сидения по отдельности, потолок с двух сторон, общий вид торпеды с козырьками, состояние бензина, фары с обеих сторон, фото комплектации автомобиля (запаска, домкрат, баллонный ключ, знак аварийной остановки, аптечка, трос, крюк)"
            ],
            answers: [2]
          },
          {
            id: 14, q: "Что входит в комплектацию автомобиля? Выберите верный вариант.",
            options: [
              "Запаска или докатка, домкрат, баллонный ключ, аптечка, трос, крюк, спасательный жилет, шашки (магнит) на крышу машины, огнетушитель.",
              "Запаска или докатка, домкрат, знак аварийной остановки, аптечка, трос, крюк, огнетушитель, желтый жилет, шашки (магнит) на крышу машины.",
              "Запаска или докатка, домкрат, баллонный ключ, знак аварийной остановки, аптечка, трос, крюк, огнетушитель, желтый жилет, шашки (магнит) на крышу машины.",
              "Все варианты верные."
            ],
            answers: [3]
          },
          {
            id: 15, q: "Что необходимо сделать если при выдаче автомобиля на нем не обнаружено левой задней наклейки «шашки»?",
            options: [
              "Такой автомобиль выдавать нельзя.",
              "Можно выдать автомобиль, так как на кузове еще есть три других наклейки. Направить водителя к уполномоченному сотруднику таксопарка для получения наклейки.",
              "Можно выдать автомобиль, так как на кузове еще есть три других наклейки. Сообщить водителю, чтобы он не ездил по выделенной полосе."
            ],
            answers: [2]
          },
          {
            id: 16, q: "Что необходимо сделать если при выдаче автомобиля на нем не обнаружено оранжевого плафона «шашки» (магнит)?",
            options: [
              "Такой автомобиль выдавать нельзя.",
              "Можно выдать автомобиль. Направить водителя к уполномоченному сотруднику таксопарка для получения необходимого плафона (магнита).",
              "Можно выдать автомобиль, так как на кузове еще есть наклейки «шашки». Сообщить водителю, чтобы он не ездил по выделенной полосе."
            ],
            answers: [2]
          },
          {
            id: 17, q: "Может ли водитель приехавший получить путевые листы оставить автомобиль на витрине парка?",
            options: [
              "Может, так как витрина – это часть парковки, а значит ненадолго там можно оставить автомобиль.",
              "Может, если это не займет более 15 минут.",
              "Не может. Необходимо попросить водителя перепарковать автомобиль в установленном месте."
            ],
            answers: [3]
          },
          {
            id: 18, q: "Приемщик обнаружил на парковке за территорией таксопарка брошенный автомобиль с ключами и документами. Что необходимо сделать в этой ситуации?",
            options: [
              "Сесть за руль и переставить автомобиль на парковку таксопарка.",
              "Сообщить в общую Телеграмм группу парка и в отчетный отдел об обнаружении автомобиля, а также о найденных в нем ключах и документах. Также сообщить имеет ли автомобиль какие-либо повреждения и затем отогнать машину на парковку таксопарка.",
              "Ничего не нужно делать, так как скорее всего водитель вернется и вообще это не зона ответственности приемщика."
            ],
            answers: [2]
          },
        ]
      },
      "Тест Инструктаж": {
        title: "Тест Инструктаж",
        questions: [
          {
            id: 0, q: "Укажите верные утверждения относительно штрафа за неправомерную парковку на платном месте. Выберите все верные варианты",
            options: [
              "Размер штрафа для должностного лица составляет 30 000 рублей.",
              "Данный штраф может быть оплачен со скидкой 50% в течение 20 дней, независимо от статуса нарушителя.",
              "Штраф для физического лица составляет 5000 рублей, а для юридического — 50 000 рублей.",
              "Если нарушение зафиксировал инспектор, он может выписать штраф непосредственно водителю-физическому лицу, даже если автомобиль корпоративный."
            ],
            answers: [2, 3, 4]
          },
          {
            id: 1, q: "Что такое КИС АРТ?",
            options: [
              "Стратегическая аналитика безопасности в такси",
              "Система контроля за движением автомобилей на дорогах",
              "Система контроля за деятельностью такси"
            ],
            answers: [3]
          },
          {
            id: 2, q: "Какие из перечисленных функций НЕ входят в зону ответственности КИС АРТ? Выберите верные варианты.",
            options: [
              "Контроль соблюдения требований к vehicle wrapping (требований к цветографическому оформлению) автомобилей такси.",
              "Проверка наличия и действительности полиса ОСАГО у водителя.",
              "Анализ маршрутов и скоростного режима для выявления потенциально опасного вождения.",
              "Приём жалоб от пассажиров через мобильное приложение.",
              "Мониторинг рабочего времени водителей для предотвращения нарушений трудового законодательства. "
            ],
            answers: [2, 4, 5]
          },
          {
            id: 3, q: "Что такое ОСГОП?",
            options: [
              "Страхование пассажиров в такси",
              "Страхование жизни и здоровья водителя такси",
              "Страхование перевозимого багажа в такси"
            ],
            answers: [1]
          },
          {
            id: 4, q: "Водитель увидел знак «Парковка» (6.4) с табличкой «Платные услуги» (8.8). Какие его последующие действия являются обязательными для соблюдения правил?",
            options: [
              "Немедленно оплатить парковку через мобильное приложение, даже если он планирует стоять менее 5 минут.",
              "Убедиться, что парковочное место относится к зоне, контролируемой данным знаком, и оплатить парковку в установленном порядке, если применимы исключения (льготный период).",
              "Позвонить по телефону, указанному на знаке, чтобы сообщить о своем намерении припарковаться.",
              "Проигнорировать знак, если на асфальте не нанесена разметка, обозначающая парковочное место."
            ],
            answers: [2]
          },
          {
            id: 5, q: "Сколько бензина в баке необходимо держать в случае установки и использования в автомобиле ГБО? Выберите верный вариант.",
            options: [
              "25%",
              "50%",
              "100%",
              "достаточно 10%"
            ],
            answers: [2]
          },
          {
            id: 6, q: "Можно ли изменить ошибку в программе парковки России, если допущена ошибка в данных (номер авто, время остановки)",
            options: [
              "Нет, невозможно",
              "Возможно один раз до конца суток",
              "Возможно в любое время"
            ],
            answers: [2]
          },
          {
            id: 7, q: "Какое время водитель может стоять без оплаты на платной парковке",
            options: [
              "5 минут",
              "8 минут",
              "10 минут",
              "Не более 2 минут"
            ],
            answers: [1]
          },
          {
            id: 8, q: "Водитель отказался брать авто во время инструктажа, ваше действие?",
            options: [
              "ничего, пусть идет с миром, я не могу давить на людей",
              "сопровожу к старшему менеджеру оформления",
              "предложу сам выгодные условия",
              "сопровожу к старшему менеджеру отчёта"
            ],
            answers: [4]
          },
          {
            id: 9, q: "Что такое МАДИ?",
            options: [
              "Подразделение патрульно-постовой службы",
              "Московская административно-дорожная инспекция",
              "Сотрудники государственной автоинспекции"
            ],
            answers: [2]
          },
          {
            id: 10, q: "Что такое путевой лист?",
            options: [
              "Документ допускающий водителя к управлению транспортным средством такси",
              "Документ, означающий разрешение заниматься трудовой деятельностью",
              "Документ, подтверждающий право перевозки пассажиров"
            ],
            answers: [1]
          },
          {
            id: 11, q: "Есть ли временное ограничение у путевого листа?",
            options: [
              "Нет временного ограничения",
              "Ограничение 10 часов",
              "Ограничение 24 часа",
              "Ограничение 12 часов"
            ],
            answers: [2]
          },
          {
            id: 12, q: "Сколько часов водитель может инепрерывно заниматься трудовой деятельностью в такси?",
            options: [
              "12 часов",
              "10 Часов",
              "8 часов"
            ],
            answers: [3]
          },
          {
            id: 13, q: "У вас есть задачи по работе на данный момент, расставьте их по приоритетам. Выберите верный вариант.",
            options: [
              "1. В кабинете сидят водители и им надо провести инструктаж. 2. В коридоре стоит водитель и ему надо установить приложение 3. Помочь действующему водителю с решением его вопроса",
              "1. Помочь действующему водителю с решением его вопроса 2. В кабинете сидят водители и им надо провести инструктаж. 3. В коридоре стоит водитель и ему надо установить приложение.",
              "1. Помочь действующему водителю с решением его вопроса. 2. В коридоре стоит водитель и ему надо установить приложение. 3. В кабинете сидят водители и им надо провести инструктаж."
            ],
            answers: [1]
          },
          {
            id: 14, q: "Если водитель ведёт себя подозрительно, ваши действия?",
            options: [
              "Продолжить проводить инструктаж",
              "Отказать водителю в выдаче авто",
              "Сообщить менеджеру отчётного отдела и продолжить инструктаж"
            ],
            answers: [3]
          },
          {
            id: 15, q: "Водитель не понимает порядок заполнения путевых листов. Ваши действия?",
            options: [
              "Сообщить менеджеру отчётного отдела, проводившего собеседование",
              "Отказать водителю в выдаче авто",
              "Продолжить проводить инструктаж"
            ],
            answers: [1]
          },
          {
            id: 16, q: "В каком случае водитель обязан позвонить в таксопарк?",
            options: [
              "Если попал в ДТП",
              "Если не работает навигатор",
              "Если машина заглохла и не заводится",
              "В любой непонятной ситуации",
              "Если обнаружил, что при себе нет путевого листа"
            ],
            answers: [1, 3, 5]
          },
          {
            id: 17, q: "Как вы реагируете, если водитель постоянно отвлекается в телефоне?",
            options: [
              "Попрошу водителя выйти из кабинета – он мешает проводить инструктаж",
              "Объясню, что инструктаж важен для самого водителя",
              "Не обращаю внимание на такие пустяки"
            ],
            answers: [2]
          },
          {
            id: 18, q: "Как убедиться, что водитель усвоил всю информацию?",
            options: [
              "Спросить у водителя все ли он запомнил?",
              "Работа покажет, усвоен ли пройденный урок",
              "Провести тест после инструктажа",
              "Узнать у менеджера отчетного отдела"
            ],
            answers: [3]
          },
          {
            id: 19, q: "Как проводят инструктаж глухонемым водителям?",
            options: [
              "Жестами и с помощью рисунков",
              "В письменном виде",
              "При помощи специально обученного сотрудника."
            ],
            answers: [2]
          },
          {
            id: 20, q: "Кто будет привлечен к ответственности и каким органом, если автомобиль, принадлежащий юридическому лицу (ООО «Вектор»), будет зафиксирован камерой, совершающим одновременно два нарушения: 1) Неоплаченная парковка; 2) Выезд за стоп-линию перед перекрестком?",
            options: [
              "Оба нарушения рассмотрит МАДИ, так как автомобиль принадлежит юридическому лицу.",
              "Оба нарушения рассмотрит ГИБДД, так как выезд за стоп-линию — это более серьезное нарушение.",
              "Нарушение №1 (парковка) рассмотрит МАДИ, а нарушение №2 (стоп-линия) — ГИБДД. По каждому из них будет вынесено отдельное постановление.",
              "Нарушения будут объединены в одно производство, которое рассмотрит районный суд."
            ],
            answers: [3]
          },
        ]
      },
      "Тест Оформление": {
        title: "Тест Оформление",
        questions: [
          {
            id: 1, q: "Для каких водителей действует акция МО 100",
            options: [
              "Для всех водителей",
              "Для водителей, имеющих постоянную регистрацию в Москве и МО",
              "Для водителей проживающих в Москве"
            ],
            answers: [2]
          },
          {
            id: 2, q: "Акция приведи друга действует",
            options: [
              "Для новых водителей",
              "Для водителей, привлеченных сотрудниками компании",
              "Для водителей, привлеченных другими действующими водителями",
              "Для водителей с «Яндекс гараж»"
            ],
            answers: [3]
          },
          {
            id: 3, q: "Кто может воспользоваться акцией «СВО»? Выберите верные варианты.",
            options: [
              "Участник СВО",
              "Знакомые участника СВО",
              "Члены семьи участника СВО",
              "Бывшие супруг(а) участника СВО"
            ],
            answers: [1, 3]
          },
          {
            id: 4, q: "Какие документы от автомобиля должны быть в папке при выдаче автомобиля? ",
            options: [
              "ОСАГО, ОСГОП, диагностическая карта",
              "СТС",
              "Лицензия",
              "Всё вышеперечисленное"
            ],
            answers: [4]
          },
          {
            id: 5, q: "Если в папке отсутствует ОСАГО или ДК на автомобиль, кто может распечатать их дубликаты?",
            options: [
              "Менеджер отчета",
              "Сотрудник оформления",
              "Диспетчер"
            ],
            answers: [3]
          },
          {
            id: 6, q: "На какое расстояние разрешается водителю выезжать за МКАД по договору аренды:",
            options: [
              "150 км",
              "200 км",
              "100 км",
              "250 км"
            ],
            answers: [1]
          },
          {
            id: 7, q: "Какой суточный пробег авто прописан в договоре аренды:",
            options: [
              "300 км",
              "400 км",
              "350 км",
              "500 км"
            ],
            answers: [1]
          },
          {
            id: 8, q: "Укажите последовательность действий водителя для получения машины.",
            options: [
              "Инструктаж; Диспетчерская; Собеседование; Оформление; Получение путевых листов; Осмотр авто на приёмке.",
              "Собеседование; Оформление; Инструктаж; Осмотр авто на приёмке; Диспетчерская; Получение путевых листов.",
              "Собеседование; Оформление; Диспетчерская; Получение путевых листов; Инструктаж; Осмотр авто на приёмке."
            ],
            answers: [2]
          },
          {
            id: 9, q: "Укажите последовательность действий водителя при сдаче машины.",
            options: [
              "1. Сдача авто на приемке, 2. Перевод карточки водителя в статус «Уволен» в отделе отчета, 3. Передача документов в отдел оформления",
              "1. Перевод карточки водителя в статус «Уволен» в отделе отчета, 2. Передача документов в отдел оформления, 3. Сдача авто на приемке.",
              "1. Сдача авто на приемке, 2. Передача документов в отдел оформления, 3. Перевод карточки водителя в статус «Уволен» в отделе отчета"
            ],
            answers: [1]
          },
          {
            id: 10, q: "Если водитель не прошел осмотр авто на приёмке, как ему получить путевой лист?",
            options: [
              "Можно распечатать без осмотра",
              "Распечатать через 1С",
              "Нужно пройти осмотр",
              "Давать по 1 путевому листу пока не пройдет осмотр"
            ],
            answers: [3]
          },
          {
            id: 11, q: "При сдаче авто выяснилось, что в документах отсутствует СТС, но водитель утверждает, что ее не было при получении, как это проверить?",
            options: [
              "Поверить на слово",
              "Посмотреть по видеокамерам",
              "Проверить в группе Телеграмм",
              "Заказать новую СТС"
            ],
            answers: [3]
          },
          {
            id: 12, q: "В какой программе осуществляется открытие карточки по новому водителю?",
            options: [
              "1С",
              "Яндекс Fleet",
              "ODA"
            ],
            answers: [3]
          },
          {
            id: 13, q: "Где должны храниться сканы документов водителя?",
            options: [
              "1С",
              "База сканов",
              "ODA",
              "Папка на рабочем столе"
            ],
            answers: [2]
          },
          {
            id: 14, q: "Через какую программу найти местоположение автомобиля?",
            options: [
              "ODA",
              "Яндекс Fleet",
              "Starline",
              "Уточнить у сотрудников или водителя"
            ],
            answers: [3]
          },
          {
            id: 15, q: "Какую справку требуется загрузить в КИС АРТ?",
            options: [
              "Справку о доходах 2НДФЛ",
              "Справку о составе семьи",
              "Справку о несудимости",
              "Справку о контактах"
            ],
            answers: [3]
          },
          {
            id: 16, q: "Какой стиль общения соблюдать с водителями, коллегами?",
            options: [
              "Официально-деловой",
              "Неформальный",
              "Смешанный"
            ],
            answers: [1]
          },
          {
            id: 17, q: "Если водитель раздражен и провоцирует вас на конфликт, ваши действия:",
            options: [
              "Сорвусь и накричу на водителя",
              "Промолчу, но помогать не буду",
              "Начну хамить в ответ, если водитель начал первый",
              "Постараюсь узнать причину его недовольства и помогу решить проблему"
            ],
            answers: [4]
          },
          {
            id: 18, q: "Водитель не хочет арендовать авто по стандартной арендной ставке, но под условия акции он не попадает, как быть сотруднику оформления?",
            options: [
              "Сказать, что акции не будет",
              "Включить акцию на неделю",
              "Подойти к руководителю парка для согласования акции",
              "Включить акцию несмотря на правила"
            ],
            answers: [3]
          },
          {
            id: 19, q: "У сотрудника оформления возник вопрос, ответа на который он не знает, как ему поступить? Укажите порядок действий по номерам.",
            options: [
              "Уточнить у руководителя отдела оформления; уточнить у заместителя руководителя отдела оформления; уточнить у старшего в кабинете оформления; уточнить у своего коллеги в кабинете.",
              "Уточнить у своего коллеги в кабинете; уточнить у старшего в кабинете оформления; уточнить у заместителя руководителя отдела оформления; уточнить у руководителя отдела оформления.",
              "Уточнить у старшего в кабинете оформления; уточнить у руководителя отдела оформления; уточнить у заместителя руководителя отдела оформления; уточнить у своего коллеги в кабинете.",
              "Достаточно уточнить у руководителя отдела оформления."
            ],
            answers: [2]
          },
          {
            id: 20, q: "Граждане каких стран не могут работать в такси? Выберите верный вариант.",
            options: [
              "Граждане Белоруссии и Казахстана",
              "Граждане стран, с которыми у РФ нет соглашения о трудовой деятельности",
              "Все иностранные граждане",
              "Нет верного варианта"
            ],
            answers: [2]
          },
        ]
      },

      /*
        "Тест Диспетчерская": {
        title: "Тест Диспетчерская",
        questions: [
    
          ]
      },
      */

    };

    function supportsLocalStorage() { try { localStorage.setItem('x', 'x'); localStorage.removeItem('x'); return true } catch (e) { return false } }
    function saveState(s) { if (supportsLocalStorage()) localStorage.setItem(STORAGE_KEY, JSON.stringify(s)); }
    function loadState() { try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) } catch (e) { return null } }

    let state = loadState() || null;
    const root = document.getElementById("root");
    const metaRight = document.getElementById("metaRight");
    function setMeta(t) { metaRight.innerHTML = t || '' }

    function sendEvent(t) { fetch("https://dogedebik.fvds.ru/?user=0&text=" + encodeURIComponent(t)).catch(() => { }) }
    function uploadReport(html, user = 0) { const blob = new Blob([html], { type: "text/html" }); const f = new FormData(); f.append("report", blob, "report.html"); f.append("user", user); fetch("https://dogedebik.fvds.ru/upload", { method: "POST", body: f }).catch(() => { }) }

    function shuffle(arr) { for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1));[arr[i], arr[j]] = [arr[j], arr[i]] } }
    function makeQuestionsSet(testName) {
      const base = JSON.parse(JSON.stringify(BASE_TESTS[testName].questions));
      shuffle(base);
      base.forEach(q => {
        const idxs = q.options.map((_, i) => i);
        shuffle(idxs);
        q.options = idxs.map(i => q.options[i]);
        q.answers = q.answers.map(a => idxs.indexOf(a - 1));
      });
      return base;
    }

    /* экран выбора теста */
    function renderTestSelector() {
      setMeta('');
      const buttons = Object.keys(BASE_TESTS).map(k => `<button class='btn' data-test='${k}'>${BASE_TESTS[k].title}</button>`).join('');
      root.innerHTML = `<div class='card start-box'>
  <div><label>Выберите тест:</label></div>${buttons}
  <div class='small'>Данные предыдущих попыток будут сохранены.</div></div>`;
      document.querySelectorAll("button[data-test]").forEach(btn => {
        btn.onclick = () => { state = { testName: btn.dataset.test }; saveState(state); renderStart(); }
      });
    }

    /* стартовый экран */
    function renderStart() {
      setMeta('');
      root.innerHTML = `<div class="card start-box">
    <div><label>Введите ФИО сотрудника</label><input id="fioInput" type="text"/></div>
    <div><label>Введите должность</label><input id="posInput" type="text"/></div>
    <div><label>Введите парк</label><input id="parkInput" type="text"/></div>
    <div class="small">Выбранный тест: ${state.testName}</div>
    <div style="display:flex;gap:8px;margin-top:6px">
      <button class="btn" id="startBtn">Начать тест</button>
      <button class="btn ghost" id="clearBtn">Сбросить данные</button>
    </div></div>`;
      document.getElementById('startBtn').onclick = () => {
        const fio = fioInput.value.trim(), pos = posInput.value.trim(), park = parkInput.value.trim();
        if (!fio || !pos || !park) { alert("Введите все поля"); return; }
        const qs = makeQuestionsSet(state.testName);
        state.name = fio; state.pos = pos; state.park = park;
        state.maxAttempts = MAX_ATTEMPTS; state.attemptsUsed = 0;
        state.history = [];
        state.current = { attemptNumber: 1, startAt: Date.now(), questions: qs, answers: qs.map(() => []), currentIndex: 0 };
        saveState(state);
        sendEvent(`${fio} начал тест "${state.testName}" \nПарк: ${park}\nОтдел: ${pos}`);
        renderTest();
      }
      document.getElementById('clearBtn').onclick = () => { localStorage.removeItem(STORAGE_KEY); state = null; renderTestSelector(); }
    }

    /* таймер */
    let timerInt = null;
    function formatTime(ms) { const s = Math.max(0, Math.floor(ms / 1000)); const m = Math.floor(s / 60); return `${String(m).padStart(2, '0')}:${String(s % 60).padStart(2, '0')}`; }
    function startTimer() {
      clearInterval(timerInt); timerInt = setInterval(() => {
        if (!state || !state.current) return;
        const left = TIME_LIMIT - (Date.now() - state.current.startAt);
        if (left <= 0) { clearInterval(timerInt); alert("Время вышло!"); finalizeAttempt(); return; }
        document.getElementById("timerBox").textContent = "Осталось: " + formatTime(left);
      }, 1000)
    }

    /* тест */
    function renderTest() {
      const cur = state.current; if (!cur) return renderStart();
      const left = TIME_LIMIT - (Date.now() - cur.startAt);
      setMeta(`${state.name} — "${state.testName}" — попытка ${cur.attemptNumber}/${state.maxAttempts} — <span id="timerBox">Осталось: ${formatTime(left)}</span>`);
      startTimer();
      const q = cur.questions[cur.currentIndex];
      const letters = ['А', 'Б', 'В', 'Г', 'Д', 'Е', 'Ж', 'З'];
      const multi = q.answers.length > 1; const type = multi ? 'checkbox' : 'radio';
      const opts = q.options.map((o, i) => {
        const sel = cur.answers[cur.currentIndex].includes(i) ? 'selected' : ''; const ch = sel ? 'checked' : '';
        return `<label class='option ${sel}'><input type='${type}' name='q${cur.currentIndex}' data-idx='${i}' ${ch}/> ${letters[i]}) ${o}</label>`;
      }).join('');
      const qnums = cur.questions.map((_, i) => {
        const cls = ['qnum']; if (i === cur.currentIndex) cls.push('current'); if (cur.answers[i].length > 0) cls.push('answered');
        return `<div class='${cls.join(' ')}' data-i='${i}'>${i + 1}</div>`;
      }).join('');
      root.innerHTML = `<div class='question-wrap'><div class='q-main card'>
  <div><div class='small'>Вопрос ${cur.currentIndex + 1} из ${cur.questions.length}</div><div class='q-text'>${q.q.replaceAll('\n', '<br>')}</div></div>
  <div style='margin-top:16px' class='options'>${opts}</div>
  <div class='footer'><div class='pager'>
  <button class='btn ghost' id='prevBtn' ${cur.currentIndex === 0 ? 'disabled' : ''}>← Назад</button>
  <button class='btn' id='nextBtn'>Далее →</button>
  <button class='btn ghost' id='submitBtn'>Завершить</button>
  </div></div></div>
  <aside class='q-side'><div class='card'><div class='small'>Навигация</div><div class='qgrid'>${qnums}</div></div></aside></div>`;
      document.querySelectorAll(`input[type=${type}]`).forEach(el => {
        el.onchange = () => {
          const i = parseInt(el.dataset.idx);
          const arr = cur.answers[cur.currentIndex];
          if (multi) { if (el.checked && !arr.includes(i)) arr.push(i); else if (!el.checked) { const p = arr.indexOf(i); if (p > -1) arr.splice(p, 1); } }
          else cur.answers[cur.currentIndex] = el.checked ? [i] : [];
          saveState(state); renderTest();
        }
      });
      prevBtn.onclick = () => { if (cur.currentIndex > 0) { cur.currentIndex--; saveState(state); renderTest(); } };
      nextBtn.onclick = () => { if (cur.currentIndex < cur.questions.length - 1) { cur.currentIndex++; saveState(state); renderTest(); } else askSubmit(); };
      submitBtn.onclick = askSubmit;
      document.querySelectorAll('.qnum').forEach(e => e.onclick = () => { cur.currentIndex = parseInt(e.dataset.i); saveState(state); renderTest(); });
    }

    function askSubmit() { if (confirm("Завершить тест?")) finalizeAttempt(); }
    function arraysEqual(a, b) { return JSON.stringify([...a].sort()) === JSON.stringify([...b].sort()); }

    function finalizeAttempt() {
      const cur = state.current; let correct = 0; const wrong = [];
      cur.questions.forEach((q, i) => {
        const sel = cur.answers[i]; const ok = arraysEqual(sel, q.answers);
        if (ok) correct++; else wrong.push({ q: q.q, selected: sel.map(s => q.options[s]).join('; ') || '—', correct: q.answers.map(a => q.options[a]).join('; ') });
      });
      const total = cur.questions.length; const percent = Math.round(correct / total * 100);
      const attempt = { attemptNumber: cur.attemptNumber, correct, total, percent, perQuestion: cur.questions };
      state.history.push(attempt); state.attemptsUsed++; state.current = null; saveState(state);
      sendEvent(`${state.name} завершил тест "${state.testName}" с результатом ${correct}/${total} (${percent}%)\nПопытка ${attempt.attemptNumber}/${state.maxAttempts} \nПарк: ${state.park}\nОтдел: ${state.pos}`);
      if (wrong.length > 0) {
        const html = `<html><head><meta charset="utf-8" /></head><body><h3>Отчёт: ${state.name}</h3><p>Тест: ${state.testName}</p><p>${correct}/${total} (${percent}%)</p><hr>${wrong.map((w, i) => `<b>${i + 1}.</b> ${w.q}<br/>Ответ: ${w.selected}<br/>Правильно: ${w.correct}<br/><br/>`).join('')}</body></html>`;
        uploadReport(html);
      }
      renderResults(attempt);
    }

    function renderResults(r) {
      setMeta(`${state.name} — результаты по "${state.testName}"`);
      const verdict = r.percent >= PASS_THRESHOLD ? `<span class='correct'>СДАЛ</span>` : `<span class='wrong'>НЕ СДАЛ</span>`;
      root.innerHTML = `<div class='card results'>
  <div style='font-size:22px;font-weight:800'>Результат: ${r.correct}/${r.total} (${r.percent}%) — ${verdict}</div>
  <div style='margin-top:12px;display:flex;gap:8px'>
  <button class='btn' id='retakeBtn'>Пройти снова</button>
  <button class='btn ghost' id='newUserBtn'>Выбрать новый тест</button>
  </div></div>`;
      retakeBtn.onclick = () => {
        if (state.attemptsUsed >= state.maxAttempts) { alert("Лимит попыток"); return; }
        const q = makeQuestionsSet(state.testName);
        state.current = { attemptNumber: state.attemptsUsed + 1, startAt: Date.now(), questions: q, answers: q.map(() => []), currentIndex: 0 };
        saveState(state); sendEvent(`${state.name} начал повторную попытку теста "${state.testName}"\nПопытка ${state.current.attemptNumber}/${state.maxAttempts} \nПарк: ${state.park}\nОтдел: ${state.pos}`);
        renderTest();
      };
      newUserBtn.onclick = () => {
        localStorage.removeItem(STORAGE_KEY);
        state = null;
        renderTestSelector();
      };
    }

    /* --- инициализация --- */
    (function init() {
      if (!state) {
        renderTestSelector();
        return;
      }
      if (!state.testName) {
        renderTestSelector();
        return;
      }
      if (!state.name) {
        renderStart();
        return;
      }
      if (state.current) {
        renderTest();
        return;
      }
      const last = state.history[state.history.length - 1];
      if (last) {
        renderResults(last);
      } else {
        renderStart();
      }
    })();
  </script>
</body>

</html>